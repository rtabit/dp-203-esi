{
	"name": "Integrating SQL and Spark pools",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool01",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "4040e28a-c0a2-4662-9ab4-d871b8181ed6"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"6bfcc465-a005-46d3-8720-60e55ad417cb": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "829",
										"3": 4,
										"4": "30.500000000000000000",
										"5": "122.000000000000000000",
										"6": "20191231",
										"7": "38.640000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "3683",
										"3": 1,
										"4": "34.440000000000000000",
										"5": "34.440000000000000000",
										"6": "20191231",
										"7": "9.940000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "812",
										"3": 1,
										"4": "28.630000000000000000",
										"5": "28.630000000000000000",
										"6": "20191231",
										"7": "7.200000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "117",
										"3": 2,
										"4": "25.500000000000000000",
										"5": "51.000000000000000000",
										"6": "20191231",
										"7": "15.660000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "406",
										"3": 3,
										"4": "36.590000000000000000",
										"5": "109.770000000000000000",
										"6": "20191231",
										"7": "34.710000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "231",
										"3": 3,
										"4": "25.580000000000000000",
										"5": "76.740000000000000000",
										"6": "20191231",
										"7": "25.020000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2689",
										"3": 3,
										"4": "24.000000000000000000",
										"5": "72.000000000000000000",
										"6": "20191231",
										"7": "19.770000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2095",
										"3": 4,
										"4": "32.380000000000000000",
										"5": "129.520000000000000000",
										"6": "20191231",
										"7": "36.000000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "92",
										"3": 1,
										"4": "15.550000000000000000",
										"5": "15.550000000000000000",
										"6": "20191231",
										"7": "4.730000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "1912",
										"3": 1,
										"4": "24.620000000000000000",
										"5": "24.620000000000000000",
										"6": "20191231",
										"7": "7.390000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"2"
									],
									"seriesFieldKeys": [
										"5"
									],
									"isStacked": false
								}
							}
						}
					},
					"804a6b7e-7a4b-406f-bc2f-bff30d164445": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "20191231",
										"1": "4443",
										"2": "2371.880000000000000000",
										"3": "2.4672",
										"4": "301"
									},
									{
										"0": "20191231",
										"1": "2647",
										"2": "15347.850000000000000000",
										"3": "2.5285",
										"4": "1555"
									},
									{
										"0": "20191231",
										"1": "223",
										"2": "47663.640000000000000000",
										"3": "2.5266",
										"4": "5076"
									},
									{
										"0": "20191231",
										"1": "3977",
										"2": "14202.540000000000000000",
										"3": "2.5668",
										"4": "1594"
									},
									{
										"0": "20191231",
										"1": "4232",
										"2": "9918.700000000000000000",
										"3": "2.4991",
										"4": "1397"
									},
									{
										"0": "20191231",
										"1": "1585",
										"2": "12404.340000000000000000",
										"3": "2.4703",
										"4": "1539"
									},
									{
										"0": "20191231",
										"1": "4646",
										"2": "1975.480000000000000000",
										"3": "2.3604",
										"4": "262"
									},
									{
										"0": "20191231",
										"1": "3036",
										"2": "1150.100000000000000000",
										"3": "2.5481",
										"4": "265"
									},
									{
										"0": "20191231",
										"1": "1620",
										"2": "17613.960000000000000000",
										"3": "2.4777",
										"4": "1613"
									},
									{
										"0": "20191231",
										"1": "669",
										"2": "2422.080000000000000000",
										"3": "2.5043",
										"4": "288"
									},
									{
										"0": "20191231",
										"1": "1655",
										"2": "3088.500000000000000000",
										"3": "2.4786",
										"4": "290"
									},
									{
										"0": "20191231",
										"1": "1527",
										"2": "2148.580000000000000000",
										"3": "2.569",
										"4": "298"
									},
									{
										"0": "20191231",
										"1": "1399",
										"2": "2797.200000000000000000",
										"3": "2.4561",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "2122",
										"2": "2080.330000000000000000",
										"3": "2.4128",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "3824",
										"2": "2486.070000000000000000",
										"3": "2.494",
										"4": "207"
									},
									{
										"0": "20191231",
										"1": "4194",
										"2": "1617.840000000000000000",
										"3": "2.4231",
										"4": "252"
									},
									{
										"0": "20191231",
										"1": "863",
										"2": "1860.240000000000000000",
										"3": "2.339",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "2034",
										"2": "2452.730000000000000000",
										"3": "2.7263",
										"4": "259"
									},
									{
										"0": "20191231",
										"1": "1213",
										"2": "1590.880000000000000000",
										"3": "2.4158",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "3298",
										"2": "1747.620000000000000000",
										"3": "2.6869",
										"4": "266"
									},
									{
										"0": "20191231",
										"1": "3079",
										"2": "2413.740000000000000000",
										"3": "2.625",
										"4": "294"
									},
									{
										"0": "20191231",
										"1": "3983",
										"2": "14352.280000000000000000",
										"3": "2.554",
										"4": "1609"
									},
									{
										"0": "20191231",
										"1": "2053",
										"2": "2604.000000000000000000",
										"3": "2.6316",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "4901",
										"2": "6881.940000000000000000",
										"3": "2.5153",
										"4": "1557"
									},
									{
										"0": "20191231",
										"1": "177",
										"2": "52192.600000000000000000",
										"3": "2.486",
										"4": "6404"
									},
									{
										"0": "20191231",
										"1": "4409",
										"2": "1760.260000000000000000",
										"3": "2.5044",
										"4": "283"
									},
									{
										"0": "20191231",
										"1": "1388",
										"2": "3491.800000000000000000",
										"3": "2.5564",
										"4": "340"
									},
									{
										"0": "20191231",
										"1": "4830",
										"2": "2997.360000000000000000",
										"3": "2.4425",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "3024",
										"2": "3446.300000000000000000",
										"3": "2.6729",
										"4": "286"
									},
									{
										"0": "20191231",
										"1": "3399",
										"2": "1673.600000000000000000",
										"3": "2.6016",
										"4": "320"
									},
									{
										"0": "20191231",
										"1": "4454",
										"2": "1376.160000000000000000",
										"3": "2.4646",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "4380",
										"2": "2092.230000000000000000",
										"3": "2.4059",
										"4": "243"
									},
									{
										"0": "20191231",
										"1": "4339",
										"2": "1094.450000000000000000",
										"3": "2.3661",
										"4": "265"
									},
									{
										"0": "20191231",
										"1": "454",
										"2": "1937.760000000000000000",
										"3": "2.4673",
										"4": "264"
									},
									{
										"0": "20191231",
										"1": "2216",
										"2": "2635.290000000000000000",
										"3": "2.4953",
										"4": "267"
									},
									{
										"0": "20191231",
										"1": "3335",
										"2": "2432.010000000000000000",
										"3": "2.5392",
										"4": "259"
									},
									{
										"0": "20191231",
										"1": "1960",
										"2": "2259.900000000000000000",
										"3": "2.5596",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "3310",
										"2": "2214.800000000000000000",
										"3": "2.5",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "3025",
										"2": "1341.120000000000000000",
										"3": "2.3519",
										"4": "254"
									},
									{
										"0": "20191231",
										"1": "1128",
										"2": "2737.050000000000000000",
										"3": "2.3578",
										"4": "257"
									},
									{
										"0": "20191231",
										"1": "4561",
										"2": "2310.860000000000000000",
										"3": "2.6706",
										"4": "227"
									},
									{
										"0": "20191231",
										"1": "3683",
										"2": "15655.500000000000000000",
										"3": "2.4842",
										"4": "1575"
									},
									{
										"0": "20191231",
										"1": "2592",
										"2": "1564.920000000000000000",
										"3": "2.4059",
										"4": "243"
									},
									{
										"0": "20191231",
										"1": "249",
										"2": "53177.360000000000000000",
										"3": "2.4761",
										"4": "5128"
									},
									{
										"0": "20191231",
										"1": "4755",
										"2": "1670.720000000000000000",
										"3": "2.3402",
										"4": "227"
									},
									{
										"0": "20191231",
										"1": "1608",
										"2": "3161.070000000000000000",
										"3": "2.5259",
										"4": "341"
									},
									{
										"0": "20191231",
										"1": "367",
										"2": "2404.980000000000000000",
										"3": "2.4052",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "2381",
										"2": "13243.420000000000000000",
										"3": "2.5023",
										"4": "1619"
									},
									{
										"0": "20191231",
										"1": "2206",
										"2": "11490.960000000000000000",
										"3": "2.519",
										"4": "1524"
									},
									{
										"0": "20191231",
										"1": "2724",
										"2": "15377.200000000000000000",
										"3": "2.5085",
										"4": "1480"
									},
									{
										"0": "20191231",
										"1": "4548",
										"2": "20172.880000000000000000",
										"3": "2.4831",
										"4": "1547"
									},
									{
										"0": "20191231",
										"1": "2931",
										"2": "2302.720000000000000000",
										"3": "2.57",
										"4": "257"
									},
									{
										"0": "20191231",
										"1": "996",
										"2": "2077.660000000000000000",
										"3": "2.4259",
										"4": "262"
									},
									{
										"0": "20191231",
										"1": "1402",
										"2": "1653.540000000000000000",
										"3": "2.54",
										"4": "254"
									},
									{
										"0": "20191231",
										"1": "451",
										"2": "1756.860000000000000000",
										"3": "2.6111",
										"4": "282"
									},
									{
										"0": "20191231",
										"1": "4679",
										"2": "2794.140000000000000000",
										"3": "2.5545",
										"4": "258"
									},
									{
										"0": "20191231",
										"1": "4396",
										"2": "2181.590000000000000000",
										"3": "2.5619",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "3798",
										"2": "2251.530000000000000000",
										"3": "2.7732",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "2487",
										"2": "9516.780000000000000000",
										"3": "2.4776",
										"4": "1494"
									},
									{
										"0": "20191231",
										"1": "4779",
										"2": "3398.640000000000000000",
										"3": "2.3496",
										"4": "289"
									},
									{
										"0": "20191231",
										"1": "1511",
										"2": "1863.040000000000000000",
										"3": "2.5038",
										"4": "328"
									},
									{
										"0": "20191231",
										"1": "368",
										"2": "2477.230000000000000000",
										"3": "2.4274",
										"4": "301"
									},
									{
										"0": "20191231",
										"1": "1278",
										"2": "3481.590000000000000000",
										"3": "2.5315",
										"4": "281"
									},
									{
										"0": "20191231",
										"1": "1908",
										"2": "3640.800000000000000000",
										"3": "2.8522",
										"4": "328"
									},
									{
										"0": "20191231",
										"1": "3581",
										"2": "2929.340000000000000000",
										"3": "2.547",
										"4": "298"
									},
									{
										"0": "20191231",
										"1": "4041",
										"2": "13716.560000000000000000",
										"3": "2.5168",
										"4": "1573"
									},
									{
										"0": "20191231",
										"1": "237",
										"2": "32047.550000000000000000",
										"3": "2.4902",
										"4": "5095"
									},
									{
										"0": "20191231",
										"1": "692",
										"2": "9760.710000000000000000",
										"3": "2.5155",
										"4": "1459"
									},
									{
										"0": "20191231",
										"1": "57",
										"2": "45311.360000000000000000",
										"3": "2.5441",
										"4": "5312"
									},
									{
										"0": "20191231",
										"1": "2890",
										"2": "12905.430000000000000000",
										"3": "2.5008",
										"4": "1553"
									},
									{
										"0": "20191231",
										"1": "1990",
										"2": "15236.500000000000000000",
										"3": "2.484",
										"4": "1550"
									},
									{
										"0": "20191231",
										"1": "3457",
										"2": "2115.000000000000000000",
										"3": "2.6549",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "3362",
										"2": "2664.420000000000000000",
										"3": "2.5208",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "790",
										"2": "2317.030000000000000000",
										"3": "2.5288",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "2045",
										"2": "3589.950000000000000000",
										"3": "2.4811",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "1991",
										"2": "1596.120000000000000000",
										"3": "2.4397",
										"4": "283"
									},
									{
										"0": "20191231",
										"1": "2435",
										"2": "3203.820000000000000000",
										"3": "2.5289",
										"4": "306"
									},
									{
										"0": "20191231",
										"1": "518",
										"2": "3602.200000000000000000",
										"3": "2.6496",
										"4": "310"
									},
									{
										"0": "20191231",
										"1": "3194",
										"2": "3461.640000000000000000",
										"3": "2.3481",
										"4": "317"
									},
									{
										"0": "20191231",
										"1": "4955",
										"2": "2159.700000000000000000",
										"3": "2.5868",
										"4": "313"
									},
									{
										"0": "20191231",
										"1": "1645",
										"2": "2120.800000000000000000",
										"3": "2.211",
										"4": "241"
									},
									{
										"0": "20191231",
										"1": "4500",
										"2": "2430.090000000000000000",
										"3": "2.5833",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "2814",
										"2": "2403.960000000000000000",
										"3": "2.5126",
										"4": "299"
									},
									{
										"0": "20191231",
										"1": "3730",
										"2": "1256.700000000000000000",
										"3": "2.5652",
										"4": "295"
									},
									{
										"0": "20191231",
										"1": "106",
										"2": "63241.800000000000000000",
										"3": "2.4698",
										"4": "6540"
									},
									{
										"0": "20191231",
										"1": "802",
										"2": "15136.400000000000000000",
										"3": "2.4345",
										"4": "1580"
									},
									{
										"0": "20191231",
										"1": "4438",
										"2": "10427.600000000000000000",
										"3": "2.511",
										"4": "1592"
									},
									{
										"0": "20191231",
										"1": "584",
										"2": "20003.760000000000000000",
										"3": "2.5015",
										"4": "1701"
									},
									{
										"0": "20191231",
										"1": "2316",
										"2": "1691.080000000000000000",
										"3": "2.6019",
										"4": "268"
									},
									{
										"0": "20191231",
										"1": "1917",
										"2": "11384.340000000000000000",
										"3": "2.5261",
										"4": "1551"
									},
									{
										"0": "20191231",
										"1": "2752",
										"2": "1852.620000000000000000",
										"3": "2.4063",
										"4": "231"
									},
									{
										"0": "20191231",
										"1": "1863",
										"2": "1796.730000000000000000",
										"3": "2.5566",
										"4": "271"
									},
									{
										"0": "20191231",
										"1": "2514",
										"2": "11996.600000000000000000",
										"3": "2.4959",
										"4": "1540"
									},
									{
										"0": "20191231",
										"1": "4256",
										"2": "2111.200000000000000000",
										"3": "2.5",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "4797",
										"2": "1216.180000000000000000",
										"3": "2.4536",
										"4": "238"
									},
									{
										"0": "20191231",
										"1": "3254",
										"2": "1958.740000000000000000",
										"3": "2.3564",
										"4": "238"
									},
									{
										"0": "20191231",
										"1": "2305",
										"2": "1716.220000000000000000",
										"3": "2.4907",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "3354",
										"2": "2633.800000000000000000",
										"3": "2.3009",
										"4": "260"
									},
									{
										"0": "20191231",
										"1": "3424",
										"2": "2713.080000000000000000",
										"3": "2.5794",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "4338",
										"2": "1946.880000000000000000",
										"3": "2.5263",
										"4": "288"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "1",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "2",
										"name": "(sum)ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "(avg)Quantity",
										"type": "double"
									},
									{
										"key": "4",
										"name": "(sum)Quantity",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"9623fae2-1567-4428-9f2b-94321c096c32": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "117880",
										"1": "2809",
										"2": "1"
									},
									{
										"0": "106897",
										"1": "1473",
										"2": "1"
									},
									{
										"0": "117881",
										"1": "606",
										"2": "1"
									},
									{
										"0": "117869",
										"1": "4669",
										"2": "1"
									},
									{
										"0": "117890",
										"1": "4365",
										"2": "1"
									},
									{
										"0": "117006",
										"1": "2874",
										"2": "1"
									},
									{
										"0": "117891",
										"1": "4558",
										"2": "1"
									},
									{
										"0": "117021",
										"1": "1701",
										"2": "1"
									},
									{
										"0": "117923",
										"1": "2071",
										"2": "1"
									},
									{
										"0": "117029",
										"1": "2089",
										"2": "1"
									},
									{
										"0": "117923",
										"1": "415",
										"2": "1"
									},
									{
										"0": "117126",
										"1": "211",
										"2": "1"
									},
									{
										"0": "117935",
										"1": "4454",
										"2": "1"
									},
									{
										"0": "117151",
										"1": "3246",
										"2": "1"
									},
									{
										"0": "117952",
										"1": "4239",
										"2": "1"
									},
									{
										"0": "117157",
										"1": "135",
										"2": "1"
									},
									{
										"0": "117954",
										"1": "2238",
										"2": "1"
									},
									{
										"0": "117169",
										"1": "1367",
										"2": "1"
									},
									{
										"0": "117971",
										"1": "2896",
										"2": "1"
									},
									{
										"0": "117183",
										"1": "3847",
										"2": "1"
									},
									{
										"0": "117977",
										"1": "4456",
										"2": "1"
									},
									{
										"0": "117240",
										"1": "4270",
										"2": "1"
									},
									{
										"0": "106005",
										"1": "2569",
										"2": "1"
									},
									{
										"0": "117244",
										"1": "4851",
										"2": "1"
									},
									{
										"0": "106010",
										"1": "2417",
										"2": "1"
									},
									{
										"0": "117270",
										"1": "503",
										"2": "1"
									},
									{
										"0": "106035",
										"1": "1783",
										"2": "1"
									},
									{
										"0": "117334",
										"1": "3946",
										"2": "1"
									},
									{
										"0": "106035",
										"1": "1046",
										"2": "1"
									},
									{
										"0": "117089",
										"1": "3102",
										"2": "1"
									},
									{
										"0": "106037",
										"1": "3411",
										"2": "1"
									},
									{
										"0": "117044",
										"1": "4323",
										"2": "1"
									},
									{
										"0": "106051",
										"1": "233",
										"2": "1"
									},
									{
										"0": "117039",
										"1": "4327",
										"2": "1"
									},
									{
										"0": "106053",
										"1": "4384",
										"2": "1"
									},
									{
										"0": "117425",
										"1": "1190",
										"2": "1"
									},
									{
										"0": "106057",
										"1": "1495",
										"2": "1"
									},
									{
										"0": "117430",
										"1": "1496",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "98",
										"2": "1"
									},
									{
										"0": "117440",
										"1": "127",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "3879",
										"2": "1"
									},
									{
										"0": "117455",
										"1": "3339",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "1888",
										"2": "1"
									},
									{
										"0": "117460",
										"1": "4468",
										"2": "1"
									},
									{
										"0": "106070",
										"1": "579",
										"2": "1"
									},
									{
										"0": "117471",
										"1": "1830",
										"2": "1"
									},
									{
										"0": "106086",
										"1": "2651",
										"2": "1"
									},
									{
										"0": "117490",
										"1": "2478",
										"2": "1"
									},
									{
										"0": "106091",
										"1": "2541",
										"2": "1"
									},
									{
										"0": "117516",
										"1": "807",
										"2": "1"
									},
									{
										"0": "106097",
										"1": "3869",
										"2": "1"
									},
									{
										"0": "117520",
										"1": "3794",
										"2": "1"
									},
									{
										"0": "106097",
										"1": "4589",
										"2": "1"
									},
									{
										"0": "117536",
										"1": "1055",
										"2": "1"
									},
									{
										"0": "106098",
										"1": "631",
										"2": "1"
									},
									{
										"0": "117565",
										"1": "3205",
										"2": "1"
									},
									{
										"0": "106100",
										"1": "3959",
										"2": "1"
									},
									{
										"0": "117572",
										"1": "4286",
										"2": "1"
									},
									{
										"0": "106107",
										"1": "1199",
										"2": "1"
									},
									{
										"0": "117614",
										"1": "3845",
										"2": "1"
									},
									{
										"0": "106118",
										"1": "1893",
										"2": "1"
									},
									{
										"0": "117618",
										"1": "800",
										"2": "1"
									},
									{
										"0": "106128",
										"1": "1760",
										"2": "1"
									},
									{
										"0": "117621",
										"1": "3269",
										"2": "1"
									},
									{
										"0": "106131",
										"1": "908",
										"2": "1"
									},
									{
										"0": "117622",
										"1": "4744",
										"2": "1"
									},
									{
										"0": "106151",
										"1": "291",
										"2": "1"
									},
									{
										"0": "117632",
										"1": "1173",
										"2": "1"
									},
									{
										"0": "106167",
										"1": "1463",
										"2": "1"
									},
									{
										"0": "117652",
										"1": "4117",
										"2": "1"
									},
									{
										"0": "106175",
										"1": "4258",
										"2": "1"
									},
									{
										"0": "117688",
										"1": "4587",
										"2": "1"
									},
									{
										"0": "106186",
										"1": "865",
										"2": "1"
									},
									{
										"0": "117695",
										"1": "4031",
										"2": "1"
									},
									{
										"0": "106201",
										"1": "4409",
										"2": "1"
									},
									{
										"0": "117757",
										"1": "4511",
										"2": "1"
									},
									{
										"0": "106208",
										"1": "1736",
										"2": "1"
									},
									{
										"0": "117780",
										"1": "138",
										"2": "1"
									},
									{
										"0": "106220",
										"1": "209",
										"2": "1"
									},
									{
										"0": "117803",
										"1": "195",
										"2": "1"
									},
									{
										"0": "106230",
										"1": "148",
										"2": "1"
									},
									{
										"0": "117814",
										"1": "249",
										"2": "1"
									},
									{
										"0": "106233",
										"1": "4552",
										"2": "1"
									},
									{
										"0": "117824",
										"1": "1934",
										"2": "1"
									},
									{
										"0": "106246",
										"1": "1984",
										"2": "1"
									},
									{
										"0": "117830",
										"1": "67",
										"2": "1"
									},
									{
										"0": "106248",
										"1": "1315",
										"2": "1"
									},
									{
										"0": "117842",
										"1": "96",
										"2": "1"
									},
									{
										"0": "106271",
										"1": "1639",
										"2": "1"
									},
									{
										"0": "106403",
										"1": "2895",
										"2": "1"
									},
									{
										"0": "106894",
										"1": "1280",
										"2": "1"
									},
									{
										"0": "106407",
										"1": "2372",
										"2": "1"
									},
									{
										"0": "117395",
										"1": "2673",
										"2": "1"
									},
									{
										"0": "106415",
										"1": "2494",
										"2": "1"
									},
									{
										"0": "117407",
										"1": "2015",
										"2": "1"
									},
									{
										"0": "106418",
										"1": "3856",
										"2": "1"
									},
									{
										"0": "117147",
										"1": "1860",
										"2": "1"
									},
									{
										"0": "106435",
										"1": "2969",
										"2": "1"
									},
									{
										"0": "117373",
										"1": "2064",
										"2": "1"
									},
									{
										"0": "106439",
										"1": "4158",
										"2": "1"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"a0661eb9-bec6-4aac-a89d-860163fb282a": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "117901",
										"1": "444",
										"2": "99"
									},
									{
										"0": "106847",
										"1": "781",
										"2": "99"
									},
									{
										"0": "117914",
										"1": "2002",
										"2": "99"
									},
									{
										"0": "117019",
										"1": "1876",
										"2": "99"
									},
									{
										"0": "117916",
										"1": "4523",
										"2": "99"
									},
									{
										"0": "117044",
										"1": "4502",
										"2": "99"
									},
									{
										"0": "117919",
										"1": "1686",
										"2": "99"
									},
									{
										"0": "117060",
										"1": "1044",
										"2": "99"
									},
									{
										"0": "117930",
										"1": "2590",
										"2": "99"
									},
									{
										"0": "117068",
										"1": "3151",
										"2": "99"
									},
									{
										"0": "117939",
										"1": "3828",
										"2": "99"
									},
									{
										"0": "117084",
										"1": "912",
										"2": "99"
									},
									{
										"0": "117946",
										"1": "511",
										"2": "99"
									},
									{
										"0": "117135",
										"1": "2972",
										"2": "99"
									},
									{
										"0": "117951",
										"1": "593",
										"2": "99"
									},
									{
										"0": "117179",
										"1": "1569",
										"2": "99"
									},
									{
										"0": "117971",
										"1": "37",
										"2": "99"
									},
									{
										"0": "117199",
										"1": "2093",
										"2": "99"
									},
									{
										"0": "117973",
										"1": "1395",
										"2": "99"
									},
									{
										"0": "117231",
										"1": "1757",
										"2": "99"
									},
									{
										"0": "117989",
										"1": "4820",
										"2": "99"
									},
									{
										"0": "117247",
										"1": "2484",
										"2": "99"
									},
									{
										"0": "117991",
										"1": "4362",
										"2": "99"
									},
									{
										"0": "117255",
										"1": "2686",
										"2": "99"
									},
									{
										"0": "117996",
										"1": "4071",
										"2": "99"
									},
									{
										"0": "117284",
										"1": "499",
										"2": "99"
									},
									{
										"0": "117998",
										"1": "3347",
										"2": "99"
									},
									{
										"0": "117287",
										"1": "503",
										"2": "99"
									},
									{
										"0": "106004",
										"1": "3853",
										"2": "99"
									},
									{
										"0": "117301",
										"1": "2087",
										"2": "99"
									},
									{
										"0": "106006",
										"1": "1862",
										"2": "99"
									},
									{
										"0": "117321",
										"1": "4648",
										"2": "99"
									},
									{
										"0": "106011",
										"1": "4345",
										"2": "99"
									},
									{
										"0": "117349",
										"1": "442",
										"2": "99"
									},
									{
										"0": "106013",
										"1": "1720",
										"2": "99"
									},
									{
										"0": "117358",
										"1": "2458",
										"2": "99"
									},
									{
										"0": "106026",
										"1": "3961",
										"2": "99"
									},
									{
										"0": "117376",
										"1": "639",
										"2": "99"
									},
									{
										"0": "106028",
										"1": "2604",
										"2": "99"
									},
									{
										"0": "117381",
										"1": "177",
										"2": "99"
									},
									{
										"0": "106034",
										"1": "4386",
										"2": "99"
									},
									{
										"0": "117404",
										"1": "2068",
										"2": "99"
									},
									{
										"0": "106037",
										"1": "1722",
										"2": "99"
									},
									{
										"0": "117420",
										"1": "1000",
										"2": "99"
									},
									{
										"0": "106038",
										"1": "3367",
										"2": "99"
									},
									{
										"0": "117421",
										"1": "2789",
										"2": "99"
									},
									{
										"0": "106042",
										"1": "1312",
										"2": "99"
									},
									{
										"0": "117423",
										"1": "2067",
										"2": "99"
									},
									{
										"0": "106043",
										"1": "3032",
										"2": "99"
									},
									{
										"0": "117427",
										"1": "2355",
										"2": "99"
									},
									{
										"0": "106047",
										"1": "4330",
										"2": "99"
									},
									{
										"0": "117435",
										"1": "18",
										"2": "99"
									},
									{
										"0": "106051",
										"1": "3441",
										"2": "99"
									},
									{
										"0": "117450",
										"1": "2877",
										"2": "99"
									},
									{
										"0": "106053",
										"1": "4679",
										"2": "99"
									},
									{
										"0": "117515",
										"1": "1863",
										"2": "99"
									},
									{
										"0": "106056",
										"1": "666",
										"2": "99"
									},
									{
										"0": "117582",
										"1": "2404",
										"2": "99"
									},
									{
										"0": "106057",
										"1": "2002",
										"2": "99"
									},
									{
										"0": "117591",
										"1": "4721",
										"2": "99"
									},
									{
										"0": "106059",
										"1": "4276",
										"2": "99"
									},
									{
										"0": "117608",
										"1": "1628",
										"2": "99"
									},
									{
										"0": "106068",
										"1": "1705",
										"2": "99"
									},
									{
										"0": "117620",
										"1": "1806",
										"2": "99"
									},
									{
										"0": "106073",
										"1": "3446",
										"2": "99"
									},
									{
										"0": "117629",
										"1": "4549",
										"2": "99"
									},
									{
										"0": "106079",
										"1": "3508",
										"2": "99"
									},
									{
										"0": "117644",
										"1": "4188",
										"2": "99"
									},
									{
										"0": "106080",
										"1": "2606",
										"2": "99"
									},
									{
										"0": "117689",
										"1": "2760",
										"2": "99"
									},
									{
										"0": "106081",
										"1": "9",
										"2": "99"
									},
									{
										"0": "117705",
										"1": "2535",
										"2": "99"
									},
									{
										"0": "106087",
										"1": "1944",
										"2": "99"
									},
									{
										"0": "117730",
										"1": "4921",
										"2": "99"
									},
									{
										"0": "106088",
										"1": "1376",
										"2": "99"
									},
									{
										"0": "117752",
										"1": "3966",
										"2": "99"
									},
									{
										"0": "106094",
										"1": "4651",
										"2": "99"
									},
									{
										"0": "117801",
										"1": "4299",
										"2": "99"
									},
									{
										"0": "106098",
										"1": "1617",
										"2": "99"
									},
									{
										"0": "117826",
										"1": "4825",
										"2": "99"
									},
									{
										"0": "106100",
										"1": "394",
										"2": "99"
									},
									{
										"0": "117835",
										"1": "2190",
										"2": "99"
									},
									{
										"0": "106103",
										"1": "3491",
										"2": "99"
									},
									{
										"0": "117870",
										"1": "967",
										"2": "99"
									},
									{
										"0": "106138",
										"1": "4254",
										"2": "99"
									},
									{
										"0": "117890",
										"1": "4607",
										"2": "99"
									},
									{
										"0": "106140",
										"1": "1427",
										"2": "99"
									},
									{
										"0": "117892",
										"1": "4263",
										"2": "99"
									},
									{
										"0": "106154",
										"1": "525",
										"2": "99"
									},
									{
										"0": "106231",
										"1": "108",
										"2": "99"
									},
									{
										"0": "106846",
										"1": "4299",
										"2": "99"
									},
									{
										"0": "106233",
										"1": "1209",
										"2": "99"
									},
									{
										"0": "117035",
										"1": "2568",
										"2": "99"
									},
									{
										"0": "106240",
										"1": "4701",
										"2": "99"
									},
									{
										"0": "117068",
										"1": "4441",
										"2": "99"
									},
									{
										"0": "106255",
										"1": "159",
										"2": "99"
									},
									{
										"0": "117087",
										"1": "3490",
										"2": "99"
									},
									{
										"0": "106258",
										"1": "2714",
										"2": "99"
									},
									{
										"0": "117194",
										"1": "4164",
										"2": "99"
									},
									{
										"0": "106283",
										"1": "4745",
										"2": "99"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"34be07ab-5940-4b51-a108-2fca9efa245d": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "20"
									},
									{
										"0": "80001",
										"1": "20"
									},
									{
										"0": "80002",
										"1": "15"
									},
									{
										"0": "80003",
										"1": "12"
									},
									{
										"0": "80004",
										"1": "10"
									},
									{
										"0": "80005",
										"1": "13"
									},
									{
										"0": "80006",
										"1": "6"
									},
									{
										"0": "80007",
										"1": "18"
									},
									{
										"0": "80008",
										"1": "4"
									},
									{
										"0": "80009",
										"1": "16"
									},
									{
										"0": "80010",
										"1": "3"
									},
									{
										"0": "80011",
										"1": "17"
									},
									{
										"0": "80012",
										"1": "19"
									},
									{
										"0": "80013",
										"1": "6"
									},
									{
										"0": "80014",
										"1": "20"
									},
									{
										"0": "80015",
										"1": "12"
									},
									{
										"0": "80016",
										"1": "6"
									},
									{
										"0": "80017",
										"1": "1"
									},
									{
										"0": "80018",
										"1": "17"
									},
									{
										"0": "80019",
										"1": "14"
									},
									{
										"0": "80020",
										"1": "9"
									},
									{
										"0": "80021",
										"1": "18"
									},
									{
										"0": "80022",
										"1": "13"
									},
									{
										"0": "80023",
										"1": "10"
									},
									{
										"0": "80024",
										"1": "4"
									},
									{
										"0": "80025",
										"1": "13"
									},
									{
										"0": "80026",
										"1": "19"
									},
									{
										"0": "80027",
										"1": "13"
									},
									{
										"0": "80028",
										"1": "1"
									},
									{
										"0": "80029",
										"1": "4"
									},
									{
										"0": "80030",
										"1": "1"
									},
									{
										"0": "80031",
										"1": "9"
									},
									{
										"0": "80032",
										"1": "17"
									},
									{
										"0": "80033",
										"1": "8"
									},
									{
										"0": "80034",
										"1": "14"
									},
									{
										"0": "80035",
										"1": "11"
									},
									{
										"0": "80036",
										"1": "19"
									},
									{
										"0": "80037",
										"1": "10"
									},
									{
										"0": "80038",
										"1": "3"
									},
									{
										"0": "80039",
										"1": "4"
									},
									{
										"0": "80040",
										"1": "17"
									},
									{
										"0": "80041",
										"1": "6"
									},
									{
										"0": "80042",
										"1": "9"
									},
									{
										"0": "80043",
										"1": "2"
									},
									{
										"0": "80044",
										"1": "19"
									},
									{
										"0": "80045",
										"1": "6"
									},
									{
										"0": "80046",
										"1": "17"
									},
									{
										"0": "80047",
										"1": "4"
									},
									{
										"0": "80048",
										"1": "13"
									},
									{
										"0": "80049",
										"1": "16"
									},
									{
										"0": "80050",
										"1": "5"
									},
									{
										"0": "80051",
										"1": "17"
									},
									{
										"0": "80052",
										"1": "9"
									},
									{
										"0": "80053",
										"1": "4"
									},
									{
										"0": "80054",
										"1": "10"
									},
									{
										"0": "80055",
										"1": "18"
									},
									{
										"0": "80056",
										"1": "13"
									},
									{
										"0": "80057",
										"1": "9"
									},
									{
										"0": "80058",
										"1": "3"
									},
									{
										"0": "80059",
										"1": "14"
									},
									{
										"0": "80060",
										"1": "4"
									},
									{
										"0": "80061",
										"1": "6"
									},
									{
										"0": "80062",
										"1": "19"
									},
									{
										"0": "80063",
										"1": "3"
									},
									{
										"0": "80064",
										"1": "3"
									},
									{
										"0": "80066",
										"1": "4"
									},
									{
										"0": "80067",
										"1": "6"
									},
									{
										"0": "80068",
										"1": "5"
									},
									{
										"0": "80069",
										"1": "11"
									},
									{
										"0": "80070",
										"1": "8"
									},
									{
										"0": "80071",
										"1": "8"
									},
									{
										"0": "80072",
										"1": "5"
									},
									{
										"0": "80073",
										"1": "14"
									},
									{
										"0": "80074",
										"1": "12"
									},
									{
										"0": "80075",
										"1": "7"
									},
									{
										"0": "80076",
										"1": "12"
									},
									{
										"0": "80077",
										"1": "1"
									},
									{
										"0": "80078",
										"1": "6"
									},
									{
										"0": "80079",
										"1": "4"
									},
									{
										"0": "80080",
										"1": "19"
									},
									{
										"0": "80081",
										"1": "14"
									},
									{
										"0": "80082",
										"1": "15"
									},
									{
										"0": "80083",
										"1": "12"
									},
									{
										"0": "80084",
										"1": "5"
									},
									{
										"0": "80086",
										"1": "7"
									},
									{
										"0": "80087",
										"1": "1"
									},
									{
										"0": "80088",
										"1": "2"
									},
									{
										"0": "80089",
										"1": "9"
									},
									{
										"0": "80090",
										"1": "1"
									},
									{
										"0": "80091",
										"1": "10"
									},
									{
										"0": "80092",
										"1": "11"
									},
									{
										"0": "80093",
										"1": "6"
									},
									{
										"0": "80094",
										"1": "19"
									},
									{
										"0": "80095",
										"1": "1"
									},
									{
										"0": "80096",
										"1": "19"
									},
									{
										"0": "80097",
										"1": "19"
									},
									{
										"0": "80098",
										"1": "15"
									},
									{
										"0": "80099",
										"1": "8"
									},
									{
										"0": "80100",
										"1": "11"
									},
									{
										"0": "80101",
										"1": "6"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "total",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"bf258cc0-be40-42f0-bc47-61ca5e8db917": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "1054"
									},
									{
										"0": "80001",
										"1": "834"
									},
									{
										"0": "80002",
										"1": "754"
									},
									{
										"0": "80003",
										"1": "684"
									},
									{
										"0": "80004",
										"1": "598"
									},
									{
										"0": "80005",
										"1": "615"
									},
									{
										"0": "80006",
										"1": "348"
									},
									{
										"0": "80007",
										"1": "932"
									},
									{
										"0": "80008",
										"1": "199"
									},
									{
										"0": "80009",
										"1": "787"
									},
									{
										"0": "80010",
										"1": "97"
									},
									{
										"0": "80011",
										"1": "931"
									},
									{
										"0": "80012",
										"1": "1042"
									},
									{
										"0": "80013",
										"1": "313"
									},
									{
										"0": "80014",
										"1": "1084"
									},
									{
										"0": "80015",
										"1": "496"
									},
									{
										"0": "80016",
										"1": "429"
									},
									{
										"0": "80017",
										"1": "76"
									},
									{
										"0": "80018",
										"1": "733"
									},
									{
										"0": "80019",
										"1": "743"
									},
									{
										"0": "80020",
										"1": "502"
									},
									{
										"0": "80021",
										"1": "921"
									},
									{
										"0": "80022",
										"1": "662"
									},
									{
										"0": "80023",
										"1": "461"
									},
									{
										"0": "80024",
										"1": "143"
									},
									{
										"0": "80025",
										"1": "747"
									},
									{
										"0": "80026",
										"1": "909"
									},
									{
										"0": "80027",
										"1": "681"
									},
									{
										"0": "80028",
										"1": "72"
									},
									{
										"0": "80029",
										"1": "227"
									},
									{
										"0": "80030",
										"1": "4"
									},
									{
										"0": "80031",
										"1": "654"
									},
									{
										"0": "80032",
										"1": "877"
									},
									{
										"0": "80033",
										"1": "331"
									},
									{
										"0": "80034",
										"1": "651"
									},
									{
										"0": "80035",
										"1": "496"
									},
									{
										"0": "80036",
										"1": "1045"
									},
									{
										"0": "80037",
										"1": "476"
									},
									{
										"0": "80038",
										"1": "139"
									},
									{
										"0": "80039",
										"1": "211"
									},
									{
										"0": "80040",
										"1": "913"
									},
									{
										"0": "80041",
										"1": "290"
									},
									{
										"0": "80042",
										"1": "427"
									},
									{
										"0": "80043",
										"1": "24"
									},
									{
										"0": "80044",
										"1": "728"
									},
									{
										"0": "80045",
										"1": "314"
									},
									{
										"0": "80046",
										"1": "613"
									},
									{
										"0": "80047",
										"1": "194"
									},
									{
										"0": "80048",
										"1": "708"
									},
									{
										"0": "80049",
										"1": "981"
									},
									{
										"0": "80050",
										"1": "234"
									},
									{
										"0": "80051",
										"1": "788"
									},
									{
										"0": "80052",
										"1": "395"
									},
									{
										"0": "80053",
										"1": "234"
									},
									{
										"0": "80054",
										"1": "391"
									},
									{
										"0": "80055",
										"1": "1137"
									},
									{
										"0": "80056",
										"1": "440"
									},
									{
										"0": "80057",
										"1": "474"
									},
									{
										"0": "80058",
										"1": "50"
									},
									{
										"0": "80059",
										"1": "677"
									},
									{
										"0": "80060",
										"1": "158"
									},
									{
										"0": "80061",
										"1": "212"
									},
									{
										"0": "80062",
										"1": "1009"
									},
									{
										"0": "80063",
										"1": "113"
									},
									{
										"0": "80064",
										"1": "132"
									},
									{
										"0": "80066",
										"1": "141"
									},
									{
										"0": "80067",
										"1": "381"
									},
									{
										"0": "80068",
										"1": "329"
									},
									{
										"0": "80069",
										"1": "524"
									},
									{
										"0": "80070",
										"1": "422"
									},
									{
										"0": "80071",
										"1": "322"
									},
									{
										"0": "80072",
										"1": "352"
									},
									{
										"0": "80073",
										"1": "770"
									},
									{
										"0": "80074",
										"1": "398"
									},
									{
										"0": "80075",
										"1": "185"
									},
									{
										"0": "80076",
										"1": "425"
									},
									{
										"0": "80077",
										"1": "84"
									},
									{
										"0": "80078",
										"1": "383"
									},
									{
										"0": "80079",
										"1": "250"
									},
									{
										"0": "80080",
										"1": "946"
									},
									{
										"0": "80081",
										"1": "540"
									},
									{
										"0": "80082",
										"1": "566"
									},
									{
										"0": "80083",
										"1": "726"
									},
									{
										"0": "80084",
										"1": "257"
									},
									{
										"0": "80086",
										"1": "270"
									},
									{
										"0": "80087",
										"1": "20"
									},
									{
										"0": "80088",
										"1": "27"
									},
									{
										"0": "80089",
										"1": "488"
									},
									{
										"0": "80090",
										"1": "34"
									},
									{
										"0": "80091",
										"1": "314"
									},
									{
										"0": "80092",
										"1": "535"
									},
									{
										"0": "80093",
										"1": "279"
									},
									{
										"0": "80094",
										"1": "937"
									},
									{
										"0": "80095",
										"1": "42"
									},
									{
										"0": "80096",
										"1": "807"
									},
									{
										"0": "80097",
										"1": "984"
									},
									{
										"0": "80098",
										"1": "744"
									},
									{
										"0": "80099",
										"1": "375"
									},
									{
										"0": "80100",
										"1": "510"
									},
									{
										"0": "80101",
										"1": "222"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "totalItemsPurchased",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"10b193b2-f5ad-451d-8ff5-1fee4a6268e8": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2857",
										"3": 4,
										"4": "20.080000000000000000",
										"5": "80.320000000000000000",
										"6": "20191230",
										"7": "24.000000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "1488",
										"3": 1,
										"4": "26.840000000000000000",
										"5": "26.840000000000000000",
										"6": "20191230",
										"7": "6.610000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "4021",
										"3": 3,
										"4": "31.120000000000000000",
										"5": "93.360000000000000000",
										"6": "20191230",
										"7": "28.110000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "728",
										"3": 1,
										"4": "28.390000000000000000",
										"5": "28.390000000000000000",
										"6": "20191230",
										"7": "9.740000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "3107",
										"3": 1,
										"4": "26.010000000000000000",
										"5": "26.010000000000000000",
										"6": "20191230",
										"7": "7.770000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2646",
										"3": 2,
										"4": "25.960000000000000000",
										"5": "51.920000000000000000",
										"6": "20191230",
										"7": "13.940000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2005",
										"3": 2,
										"4": "32.460000000000000000",
										"5": "64.920000000000000000",
										"6": "20191230",
										"7": "17.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2848",
										"3": 4,
										"4": "20.200000000000000000",
										"5": "80.800000000000000000",
										"6": "20191230",
										"7": "28.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "248",
										"3": 2,
										"4": "25.490000000000000000",
										"5": "50.980000000000000000",
										"6": "20191230",
										"7": "13.340000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "141",
										"3": 4,
										"4": "22.130000000000000000",
										"5": "88.520000000000000000",
										"6": "20191230",
										"7": "24.480000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"1"
									],
									"isStacked": false
								}
							}
						}
					},
					"518033c0-3a78-4740-9171-7a4ab1f39f94": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "107993",
										"1": "4625",
										"2": "15"
									},
									{
										"0": "107993",
										"1": "1308",
										"2": "86"
									},
									{
										"0": "107993",
										"1": "3788",
										"2": "83"
									},
									{
										"0": "107993",
										"1": "2544",
										"2": "80"
									},
									{
										"0": "107993",
										"1": "710",
										"2": "43"
									},
									{
										"0": "107993",
										"1": "236",
										"2": "37"
									},
									{
										"0": "107993",
										"1": "1725",
										"2": "30"
									},
									{
										"0": "107993",
										"1": "3430",
										"2": "69"
									},
									{
										"0": "107993",
										"1": "2239",
										"2": "74"
									},
									{
										"0": "107993",
										"1": "3458",
										"2": "50"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"3ba37222-90e6-4428-9e25-c0858563cac5": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80296",
										"1": "202",
										"2": "96.920000000000000000",
										"3": "4",
										"4": "52"
									},
									{
										"0": "80347",
										"1": "4232",
										"2": "48.860000000000000000",
										"3": "2",
										"4": "89"
									},
									{
										"0": "80351",
										"1": "244",
										"2": "83.960000000000000000",
										"3": "4",
										"4": "83"
									},
									{
										"0": "80659",
										"1": "2433",
										"2": "45.520000000000000000",
										"3": "2",
										"4": "63"
									},
									{
										"0": "80922",
										"1": "963",
										"2": "100.680000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "81027",
										"1": "2158",
										"2": "43.460000000000000000",
										"3": "2",
										"4": "54"
									},
									{
										"0": "81180",
										"1": "109",
										"2": "207.920000000000000000",
										"3": "8",
										"4": "50"
									},
									{
										"0": "81686",
										"1": "3128",
										"2": "64.240000000000000000",
										"3": "2",
										"4": "93"
									},
									{
										"0": "82401",
										"1": "87",
										"2": "18.430000000000000000",
										"3": "1",
										"4": "56"
									},
									{
										"0": "82442",
										"1": "3318",
										"2": "152.040000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "82467",
										"1": "3033",
										"2": "72.720000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "82625",
										"1": "104",
										"2": "35.230000000000000000",
										"3": "1",
										"4": "58"
									},
									{
										"0": "82983",
										"1": "802",
										"2": "58.800000000000000000",
										"3": "2",
										"4": "4"
									},
									{
										"0": "83417",
										"1": "24",
										"2": "22.280000000000000000",
										"3": "1",
										"4": "60"
									},
									{
										"0": "83425",
										"1": "158",
										"2": "45.240000000000000000",
										"3": "2",
										"4": "26"
									},
									{
										"0": "83704",
										"1": "3164",
										"2": "116.880000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "84189",
										"1": "103",
										"2": "51.780000000000000000",
										"3": "2",
										"4": "29"
									},
									{
										"0": "84245",
										"1": "177",
										"2": "68.940000000000000000",
										"3": "3",
										"4": "5"
									},
									{
										"0": "84418",
										"1": "4412",
										"2": "64.800000000000000000",
										"3": "2",
										"4": "70"
									},
									{
										"0": "84464",
										"1": "2043",
										"2": "66.600000000000000000",
										"3": "3",
										"4": "11"
									},
									{
										"0": "84483",
										"1": "1335",
										"2": "115.560000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "84543",
										"1": "1379",
										"2": "29.290000000000000000",
										"3": "1",
										"4": "87"
									},
									{
										"0": "84558",
										"1": "116",
										"2": "49.380000000000000000",
										"3": "3",
										"4": "10"
									},
									{
										"0": "84833",
										"1": "63",
										"2": "31.670000000000000000",
										"3": "1",
										"4": "41"
									},
									{
										"0": "85070",
										"1": "4882",
										"2": "58.740000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "85161",
										"1": "162",
										"2": "64.420000000000000000",
										"3": "2",
										"4": "99"
									},
									{
										"0": "85170",
										"1": "2934",
										"2": "103.860000000000000000",
										"3": "6",
										"4": "52"
									},
									{
										"0": "85501",
										"1": "682",
										"2": "74.280000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "86205",
										"1": "3173",
										"2": "52.940000000000000000",
										"3": "2",
										"4": "15"
									},
									{
										"0": "86205",
										"1": "115",
										"2": "61.580000000000000000",
										"3": "2",
										"4": "53"
									},
									{
										"0": "86349",
										"1": "768",
										"2": "127.440000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "86456",
										"1": "347",
										"2": "29.590000000000000000",
										"3": "1",
										"4": "52"
									},
									{
										"0": "86557",
										"1": "4475",
										"2": "86.640000000000000000",
										"3": "4",
										"4": "37"
									},
									{
										"0": "86629",
										"1": "200",
										"2": "74.340000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "86641",
										"1": "72",
										"2": "52.060000000000000000",
										"3": "2",
										"4": "9"
									},
									{
										"0": "86811",
										"1": "3635",
										"2": "88.800000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "86846",
										"1": "152",
										"2": "75.870000000000000000",
										"3": "3",
										"4": "72"
									},
									{
										"0": "87075",
										"1": "1777",
										"2": "139.240000000000000000",
										"3": "4",
										"4": "35"
									},
									{
										"0": "87086",
										"1": "2362",
										"2": "35.520000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "87095",
										"1": "2911",
										"2": "65.720000000000000000",
										"3": "2",
										"4": "80"
									},
									{
										"0": "87103",
										"1": "92",
										"2": "77.750000000000000000",
										"3": "5",
										"4": "82"
									},
									{
										"0": "87126",
										"1": "154",
										"2": "52.280000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "87126",
										"1": "172",
										"2": "36.970000000000000000",
										"3": "1",
										"4": "46"
									},
									{
										"0": "87142",
										"1": "101",
										"2": "127.500000000000000000",
										"3": "3",
										"4": "60"
									},
									{
										"0": "87314",
										"1": "2885",
										"2": "26.610000000000000000",
										"3": "1",
										"4": "67"
									},
									{
										"0": "87480",
										"1": "3496",
										"2": "94.620000000000000000",
										"3": "3",
										"4": "56"
									},
									{
										"0": "87546",
										"1": "3918",
										"2": "74.460000000000000000",
										"3": "3",
										"4": "70"
									},
									{
										"0": "87607",
										"1": "2307",
										"2": "141.720000000000000000",
										"3": "4",
										"4": "17"
									},
									{
										"0": "87690",
										"1": "114",
										"2": "153.920000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "88259",
										"1": "2396",
										"2": "23.530000000000000000",
										"3": "1",
										"4": "22"
									},
									{
										"0": "88440",
										"1": "5",
										"2": "50.620000000000000000",
										"3": "2",
										"4": "23"
									},
									{
										"0": "88485",
										"1": "226",
										"2": "71.790000000000000000",
										"3": "3",
										"4": "20"
									},
									{
										"0": "88518",
										"1": "2287",
										"2": "46.480000000000000000",
										"3": "2",
										"4": "16"
									},
									{
										"0": "88750",
										"1": "633",
										"2": "65.320000000000000000",
										"3": "2",
										"4": "30"
									},
									{
										"0": "88796",
										"1": "885",
										"2": "26.170000000000000000",
										"3": "1",
										"4": "17"
									},
									{
										"0": "88858",
										"1": "199",
										"2": "66.660000000000000000",
										"3": "2",
										"4": "45"
									},
									{
										"0": "89226",
										"1": "3769",
										"2": "20.630000000000000000",
										"3": "1",
										"4": "12"
									},
									{
										"0": "89283",
										"1": "1772",
										"2": "105.840000000000000000",
										"3": "4",
										"4": "34"
									},
									{
										"0": "89976",
										"1": "2006",
										"2": "74.240000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "90083",
										"1": "315",
										"2": "118.880000000000000000",
										"3": "4",
										"4": "9"
									},
									{
										"0": "90131",
										"1": "4896",
										"2": "46.260000000000000000",
										"3": "2",
										"4": "34"
									},
									{
										"0": "90335",
										"1": "1441",
										"2": "21.270000000000000000",
										"3": "1",
										"4": "1"
									},
									{
										"0": "90367",
										"1": "3575",
										"2": "136.320000000000000000",
										"3": "4",
										"4": "39"
									},
									{
										"0": "90652",
										"1": "34",
										"2": "88.000000000000000000",
										"3": "4",
										"4": "79"
									},
									{
										"0": "90671",
										"1": "195",
										"2": "24.140000000000000000",
										"3": "1",
										"4": "7"
									},
									{
										"0": "91493",
										"1": "4549",
										"2": "17.750000000000000000",
										"3": "1",
										"4": "31"
									},
									{
										"0": "91646",
										"1": "202",
										"2": "72.690000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "91798",
										"1": "224",
										"2": "125.970000000000000000",
										"3": "3",
										"4": "62"
									},
									{
										"0": "91817",
										"1": "3651",
										"2": "101.820000000000000000",
										"3": "3",
										"4": "40"
									},
									{
										"0": "92030",
										"1": "98",
										"2": "83.250000000000000000",
										"3": "3",
										"4": "88"
									},
									{
										"0": "92293",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "92456",
										"1": "242",
										"2": "104.560000000000000000",
										"3": "4",
										"4": "98"
									},
									{
										"0": "92543",
										"1": "173",
										"2": "95.320000000000000000",
										"3": "4",
										"4": "60"
									},
									{
										"0": "92565",
										"1": "4069",
										"2": "87.480000000000000000",
										"3": "3",
										"4": "93"
									},
									{
										"0": "92581",
										"1": "94",
										"2": "85.680000000000000000",
										"3": "3",
										"4": "54"
									},
									{
										"0": "92623",
										"1": "2015",
										"2": "31.660000000000000000",
										"3": "1",
										"4": "43"
									},
									{
										"0": "92794",
										"1": "2252",
										"2": "23.790000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "92961",
										"1": "780",
										"2": "68.340000000000000000",
										"3": "3",
										"4": "66"
									},
									{
										"0": "93136",
										"1": "169",
										"2": "155.160000000000000000",
										"3": "4",
										"4": "74"
									},
									{
										"0": "93204",
										"1": "464",
										"2": "92.480000000000000000",
										"3": "4",
										"4": "13"
									},
									{
										"0": "93507",
										"1": "170",
										"2": "55.700000000000000000",
										"3": "2",
										"4": "84"
									},
									{
										"0": "93533",
										"1": "81",
										"2": "51.560000000000000000",
										"3": "2",
										"4": "19"
									},
									{
										"0": "93687",
										"1": "124",
										"2": "26.150000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "93837",
										"1": "2194",
										"2": "77.550000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "94256",
										"1": "2939",
										"2": "24.670000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "94337",
										"1": "3143",
										"2": "43.700000000000000000",
										"3": "2",
										"4": "48"
									},
									{
										"0": "94573",
										"1": "4276",
										"2": "28.970000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "94643",
										"1": "213",
										"2": "87.210000000000000000",
										"3": "3",
										"4": "12"
									},
									{
										"0": "94839",
										"1": "4472",
										"2": "25.260000000000000000",
										"3": "1",
										"4": "89"
									},
									{
										"0": "94914",
										"1": "4767",
										"2": "63.000000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "95324",
										"1": "4866",
										"2": "142.920000000000000000",
										"3": "4",
										"4": "3"
									},
									{
										"0": "95392",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "41"
									},
									{
										"0": "95546",
										"1": "3393",
										"2": "91.350000000000000000",
										"3": "3",
										"4": "96"
									},
									{
										"0": "95760",
										"1": "4458",
										"2": "34.270000000000000000",
										"3": "1",
										"4": "78"
									},
									{
										"0": "95776",
										"1": "2138",
										"2": "111.960000000000000000",
										"3": "4",
										"4": "47"
									},
									{
										"0": "95857",
										"1": "4837",
										"2": "26.750000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "95903",
										"1": "135",
										"2": "72.480000000000000000",
										"3": "2",
										"4": "18"
									},
									{
										"0": "96097",
										"1": "4987",
										"2": "74.900000000000000000",
										"3": "2",
										"4": "52"
									},
									{
										"0": "96124",
										"1": "3319",
										"2": "119.480000000000000000",
										"3": "4",
										"4": "33"
									},
									{
										"0": "96219",
										"1": "3269",
										"2": "40.040000000000000000",
										"3": "2",
										"4": "10"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "TotalAmountDecember",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "TotalQuantityDecember",
										"type": "bigint"
									},
									{
										"key": "4",
										"name": "TotalItemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/e9e3642f-d367-4a55-a303-99ef26cea082/resourceGroups/data-engineering-synapse-67xklnc/providers/Microsoft.Synapse/workspaces/asaworkspace67xklnc/bigDataPools/SparkPool01",
				"name": "SparkPool01",
				"type": "Spark",
				"endpoint": "https://asaworkspace67xklnc.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://wwi-02@asadatalake67xklnc.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/Day=20191231/sale-small-20191231-snappy.parquet', format='parquet')\r\n",
					"display(df.limit(10))\r\n",
					"\r\n",
					"datalake = 'asadatalake67xklnc'"
				],
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.printSchema()"
				],
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"profitByDateProduct = (df.groupBy(\"TransactionDate\",\"ProductId\")\r\n",
					"    .agg(\r\n",
					"        sum(\"ProfitAmount\").alias(\"(sum)ProfitAmount\"),\r\n",
					"        round(avg(\"Quantity\"), 4).alias(\"(avg)Quantity\"),\r\n",
					"        sum(\"Quantity\").alias(\"(sum)Quantity\"))\r\n",
					"    .orderBy(\"TransactionDate\"))\r\n",
					"display(profitByDateProduct.limit(100))"
				],
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df = (spark.read \\\r\n",
					"        .option('inferSchema', 'true') \\\r\n",
					"        .json('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/online-user-profiles-02/*.json', multiLine=True)\r\n",
					"    )\r\n",
					"\r\n",
					"df.printSchema()"
				],
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# create a view called user_profiles\r\n",
					"df.createOrReplaceTempView(\"user_profiles\")"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"SELECT * FROM user_profiles LIMIT 10"
				],
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from pyspark.sql.functions import udf, explode\r\n",
					"\r\n",
					"flat=df.select('visitorId',explode('topProductPurchases').alias('topProductPurchases_flat'))\r\n",
					"flat.show(100)"
				],
				"execution_count": 7
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"topPurchases = (flat.select('visitorId','topProductPurchases_flat.productId','topProductPurchases_flat.itemsPurchasedLast12Months')\r\n",
					"    .orderBy('visitorId'))\r\n",
					"\r\n",
					"topPurchases.show(100)"
				],
				"execution_count": 8
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Let's order by the number of items purchased in the last 12 months\r\n",
					"sortedTopPurchases = topPurchases.orderBy(\"itemsPurchasedLast12Months\")\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))"
				],
				"execution_count": 9
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"topPurchases.orderBy(\"itemsPurchasedLast12Months desc\")"
				],
				"execution_count": 10
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"sortedTopPurchases = (topPurchases\r\n",
					"    .orderBy( col(\"itemsPurchasedLast12Months\").desc() ))\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))"
				],
				"execution_count": 11
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(count(\"*\").alias(\"total\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))"
				],
				"execution_count": 12
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\",\"itemsPurchasedLast12Months\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(sum(\"itemsPurchasedLast12Months\").alias(\"totalItemsPurchased\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))"
				],
				"execution_count": 13
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Create a temporary view for top purchases so we can load from Scala\r\n",
					"topPurchases.createOrReplaceTempView(\"top_purchases\")"
				],
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the dedcated SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df = spark.sqlContext.sql(\"select * from top_purchases\")\r\n",
					"df.write.synapsesql(\"SQLPool01.wwi.TopPurchases\", Constants.INTERNAL)"
				],
				"execution_count": 15
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfsales = spark.read.load('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/*/*.parquet', format='parquet')\r\n",
					"display(dfsales.limit(10))"
				],
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df2 = spark.read.synapsesql(\"SQLPool01.wwi.TopPurchases\")\r\n",
					"df2.createTempView(\"top_purchases_sql\")\r\n",
					"\r\n",
					"df2.head(10)"
				],
				"execution_count": 17
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfTopPurchasesFromSql = sqlContext.table(\"top_purchases_sql\")\r\n",
					"\r\n",
					"display(dfTopPurchasesFromSql.limit(10))"
				],
				"execution_count": 18
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"inner_join = dfsales.join(dfTopPurchasesFromSql,\r\n",
					"    (dfsales.CustomerId == dfTopPurchasesFromSql.visitorId) & (dfsales.ProductId == dfTopPurchasesFromSql.productId))\r\n",
					"\r\n",
					"inner_join_agg = (inner_join.select(\"CustomerId\",\"TotalAmount\",\"Quantity\",\"itemsPurchasedLast12Months\",\"top_purchases_sql.productId\")\r\n",
					"    .groupBy([\"CustomerId\",\"top_purchases_sql.productId\"])\r\n",
					"    .agg(\r\n",
					"        sum(\"TotalAmount\").alias(\"TotalAmountDecember\"),\r\n",
					"        sum(\"Quantity\").alias(\"TotalQuantityDecember\"),\r\n",
					"        sum(\"itemsPurchasedLast12Months\").alias(\"TotalItemsPurchasedLast12Months\"))\r\n",
					"    .orderBy(\"CustomerId\") )\r\n",
					"\r\n",
					"display(inner_join_agg.limit(100))"
				],
				"execution_count": 19
			}
		]
	}
}